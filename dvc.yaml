vars:
  - params.yaml

stages:
  data_loader:
    cmd: python -m src.main --stage data_loader
    deps:
      - src/data/data_loader.py
      - ${data.raw_path}
    outs:
      - ${data.processed_path}

  feature_engineering:
    cmd: python -m src.main --stage feature_engineering
    deps:
      - src/data/feature_engineer.py
      - ${data.processed_path}
    outs:
      - data/interim/features.csv

  train:
    cmd: python -m src.main --stage train
    deps:
      - src/models/xgboost_model/model_trainer.py
      - src/models/random_forest_model/model_trainer.py
      - src/models/linear_regression_model/model_trainer.py
      - data/interim/features.csv
    params:
      - train.model_type
      - train.cv_folds
      # XGBoost params
      - train.xgboost.n_estimators
      - train.xgboost.learning_rate
      - train.xgboost.max_depth
      - train.xgboost.subsample
      - train.xgboost.colsample_bytree
      - train.xgboost.eval_metric
      - train.xgboost.random_state
      - train.xgboost.n_jobs
      # Random Forest params
      - train.random_forest.n_estimators
      - train.random_forest.max_depth
      - train.random_forest.min_samples_split
      - train.random_forest.min_samples_leaf
      - train.random_forest.max_features
      - train.random_forest.random_state
      - train.random_forest.n_jobs
      # Linear Regression params
      - train.linear_regression.fit_intercept
      - train.linear_regression.n_jobs
    outs:
      - models/current/
